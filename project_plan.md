# 민호와 민아 프로젝트 계획

## 프로젝트 개요
- **프로젝트명**: 민호와 민아의 소중한 순간들
- **기술 스택**: React, TypeScript, Tailwind CSS, Supabase
- **다국어 지원**: 한국어, 태국어, 영어

## 완료된 작업
- ✅ React 개발 환경 구축
- ✅ 디자인 시스템 문서화
- ✅ 기존 스타일 마이그레이션
- ✅ 다국어 지원 시스템
- ✅ 메모리 갤러리 나이별 필터 및 슬라이드쇼
- ✅ 메모리 갤러리 인물 필터 중복 문제 해결
- ✅ 페이지별 레이아웃 최적화 (포토북, 통계, 성장기록)

### 문서화된 내용
- `/docs/DESIGN_SYSTEM.md`: 디자인 시스템 가이드
- `/docs/DESIGN_MIGRATION_GUIDE.md`: 디자인 마이그레이션 가이드
- `/docs/CHILDREN_INFO.md`: 민호와 민아 정보 및 나이별 필터 시스템

## 진행 중인 작업
### ✅ 다국어 지원 시스템 구현 (완료)
- [x] 언어 변환기 UI 구현
- [x] i18n 시스템 설정 (Context API 사용)
- [x] 번역 파일 구성 (한국어, 태국어, 영어)
- [x] 언어 전환 기능 구현
- [x] 깔끔한 언어 선택기 컴포넌트 생성
- [x] Layout 컴포넌트에 언어 선택기 통합
- [x] 모든 메뉴 아이템 번역 적용
- [x] 로그인/로그아웃 버튼 번역 적용
- [x] 모바일 메뉴 번역 적용
- [x] CSS 애니메이션 추가 (slideIn)

## 진행 중인 작업
### ✅ 번역 시스템 전체 페이지 적용 (2025-01-17) - 완료
- [x] 모든 페이지에 번역 시스템 적용
  - [x] HomePage (index) - 완료
  - [x] UploadPage - 완료
  - [x] MemoriesPage - 완료 (버그 수정 포함)
  - [x] GrowthPage - 완료
  - [x] StatisticsPage - 완료 (2025-01-17)
  - [x] AlbumsPage - 완료 (2025-01-17)
  - [x] PhotobookCreatorPage - 완료 (2025-01-17)
  - [x] ActivityLogPage - 완료 (2025-01-17)
  - [x] TrashPage - 완료 (2025-01-17)
  - [x] ProfilePage - 완료 (2025-01-17)
  - [x] Backup - 완료 (2025-01-17)

### ✅ 백업 페이지 마이그레이션 (2025-01-17) - 완료
- [x] backup.html을 React 컴포넌트로 마이그레이션
- [x] 가족 메뉴를 가족설정으로 변경
- [x] 가족설정 드롭다운에 백업 메뉴 추가
- [x] 백업 기능 UI 구현 (전체/추억/설정 백업)
- [x] 백업 복원 UI 구현
- [x] 자동 백업 설정 UI 구현
- [x] 번역 시스템 통합 (한국어, 영어, 태국어)

## 완료된 작업
### ✅ UI/UX 개선 작업 (2025-01-16)
- [x] 로그인 버튼 심플하게 개선
- [x] 언어 변환기 국기 이미지 적용 및 디자인 개선

## 예정된 작업
- [x] 메모리 갤러리 페이지 - 나이별 필터와 슬라이드쇼 기능 추가
- [ ] 사진/동영상 업로드 기능
- [ ] Supabase 백엔드 연동
- [ ] 인증 시스템
- [ ] 배포

## 작업 로그
### 2025-01-16
- 프로젝트 계획 문서 생성
- 다국어 지원 시스템 구현 완료
  - 한국어, 태국어, 영어 3개 언어 지원
  - Context API 기반 언어 관리 시스템
  - 깔끔한 드롭다운 방식의 언어 선택기
  - 모든 컴포넌트에서 useLanguage 훅으로 번역 사용 가능
- 메뉴 구성 복원
  - 백업 폴더 참조로 인해 추가되었던 메뉴 제거 (family-settings, share, backup)
  - 원래 메뉴 구성으로 복원
- 메모리 갤러리 페이지 기능 추가
  - 나이별 필터 (0세~20세) 추가
  - 민호와 민아의 현재 나이 자동 표시 (이모지 포함)
  - 민호 나이: 파란색 테두리/배경색과 👦 이모지
  - 민아 나이: 분홍색 테두리/배경색과 👧 이모지
  - 슬라이드쇼 기능 추가 (3초 자동 재생)
  - 슬라이드쇼 네비게이션 및 인디케이터 추가
  - 민호/민아 생년월일 설정
    - 민호: 2018년 3월 18일생
    - 민아: 2019년 8월 3일생
- 빌드 및 배포 설정
  - TypeScript 타입 에러 수정
  - memory.ts 타입 정의 파일 생성
  - Vercel 배포 설정 수정 (React 앱 지원)
- UI/UX 개선
  - 로그인/로그아웃 버튼을 심플한 텍스트 스타일로 변경
  - 언어 선택기를 국기 이미지(SVG)로 변경
  - 테두리 제거하고 미니멀한 디자인 적용
  - 국기 이미지 경로:
    - 한국어: /assets/images/flags/ko.svg
    - 태국어: /assets/images/flags/th.svg
    - 영어: /assets/images/flags/en.svg
  - 사용자 피드백 반영:
    - 로그인 버튼을 원래의 그라데이션 스타일로 복원
    - 언어 선택기 드롭다운 메뉴 너비 확장 (min-w-[120px])
    - whitespace-nowrap 적용으로 텍스트 줄바꿈 방지

### 2025-01-17
- 메모리 갤러리 페이지 버그 수정
  - 인물 필터 중복 표시 문제 해결
  - 하드코딩된 민호/민아 옵션 제거
  - DB에서 가져온 people 데이터만 사용하도록 수정
  - /memories 페이지의 인물 필터가 이제 정확히 등록된 2개의 인물만 표시
- 레이아웃 개선 작업
  - 포토북 만들기 페이지: 타이틀 수직 중앙 정렬
    - Hero Section에 flexbox 적용 및 padding 조정
    - minHeight 추가로 적절한 높이 확보
  - 통계 페이지: 좌우 여백 추가
    - max-w-7xl mx-auto 클래스로 적절한 너비 제한
    - /memories 페이지와 동일한 레이아웃 일관성 확보
    - pt-8 추가로 상단 여백 개선
  - 성장 기록 페이지: 히어로 섹션 제외 컨텐츠에 좌우 여백 추가
    - 히어로 섹션은 전체 너비 유지
    - 인물 선택 버튼부터 시작되는 모든 컨텐츠에 container 적용
    - max-w-7xl mx-auto px-4로 적절한 여백 설정
- 백업 페이지 마이그레이션
  - backup.html을 React 컴포넌트로 완전 마이그레이션
  - Backup.tsx 컴포넌트 생성
    - 전체 백업, 추억 백업, 설정 백업 기능 UI 구현
    - 백업 복원 기능 (드래그 앤 드롭 지원)
    - 자동 백업 설정 UI
    - 백업 기록 표시 영역
  - 번역 시스템 통합
    - 한국어, 영어, 태국어 번역 추가
    - 모든 UI 텍스트 다국어 지원
  - 라우팅 설정
    - /backup 라우트 추가
    - PrivateRoute로 인증 필요 설정
  - 네비게이션 개선
    - "가족" 메뉴를 "가족설정"으로 변경
    - 가족설정 드롭다운에 백업 메뉴 추가
    - FiDatabase 아이콘 적용
- MemoriesPage 번역 작업 완료 (2025-01-17)
  - 모든 하드코딩된 텍스트를 번역 키로 변경
  - 페이지 제목, 버튼, 필터, 검색, 모달 등 모든 텍스트 번역
  - 에러 메시지 및 로딩 상태 텍스트 번역
  - 나이 표시 (세), 사진 개수 표시 등 동적 텍스트 번역
- ActivityLogPage 번역 작업 완료 (2025-01-17)
  - 모든 하드코딩된 텍스트를 번역 키로 변경
  - 페이지 제목, 필터 옵션, 내보내기 버튼 번역
  - 활동 없음 메시지 및 설명 번역
  - 각 활동 유형별 메시지 번역 (생성, 수정, 삭제, 복원, 공유, 다운로드)
- TrashPage 번역 작업 완료 (2025-01-17)
  - 모든 하드코딩된 텍스트를 번역 키로 변경
  - 페이지 제목, 자동 삭제 안내 메시지 번역
  - 선택 관련 버튼 및 카운터 번역
  - 복원/영구 삭제 버튼 번역
  - 빈 휴지통 메시지 번역
  - 삭제일 및 영구 삭제 예정일 표시 번역
- ProfilePage 번역 작업 완료 (2025-01-17)
  - 모든 하드코딩된 텍스트를 번역 키로 변경
  - 페이지 제목, 에러/성공 메시지 번역
  - 폼 레이블 및 placeholder 번역
  - 역할 배지 및 설명 번역
  - 버튼 텍스트 번역
  - 계정 정보 섹션 번역

### 번역 시스템 연동 완료 (2025-01-17)
- 모든 주요 페이지에 번역 시스템 적용 완료:
  - MemoriesPage ✓
  - GrowthPage ✓ (이미 적용되어 있었음)
  - StatisticsPage ✓
  - AlbumsPage ✓
  - PhotobookCreatorPage ✓
  - ActivityLogPage ✓
  - UploadPage ✓ (일부 추가 번역 키 적용)
  - TrashPage ✓
  - ProfilePage ✓
  - HomePage ✓ (이미 적용되어 있었음)
- 한국어, 영어, 태국어 3개 언어 지원
- 모든 UI 텍스트가 다국어 지원됨

### 2025-01-17 (오늘)
- **번역 시스템 버그 수정**
  - MemoriesPage에서 언어 변환이 작동하지 않던 문제 해결
  - 번역 파일들의 memories 섹션을 플랫 구조에서 중첩 객체 구조로 변경
  - ko.ts, en.ts, th.ts 파일의 memories 관련 키들을 객체 형태로 재구성
  - 예: `memories_title` → `memories: { title: ... }`
  - LanguageContext의 t 함수가 중첩된 키(예: 'memories.title')를 처리하도록 개선
  - 이제 MemoriesPage에서 한국어/영어/태국어 전환이 정상 작동함
- **나이 표시 형식 개선**
  - MemoriesPage의 나이별 필터에서 언어별로 다른 형식 적용
  - 한국어: "1세", "2세", "3세"...
  - 영어: "1 year old", "2 years old", "3 years old"...
  - 태국어: "1 ปี", "2 ปี", "3 ปี"...
  - useLanguage 훅의 language 값을 사용하여 현재 언어 감지
- **레거시 파일 정리 실패 및 복구**
  - 레거시 CSS/JS 파일들을 삭제했으나 페이지가 깨짐
  - git revert로 파일들 복구
  - 프로덕션 배포 시 CSS 로드 문제 발생
  - 프로덕션 사이트(minhominah.com)는 정상 작동 확인
  - 브라우저 캐시 클리어로 문제 해결
- **개발 서버 정리**
  - 3000, 3001 포트에서 중복 실행되던 서버 정리
  - 모든 기존 프로세스 종료 후 3000 포트에서만 재실행
  - localhost:3000 정상 작동 확인
- **메모리 페이지 드롭다운 메뉴 버그 수정**
  - /memories 페이지에서 점점점(더보기) 메뉴 클릭 시 수정/삭제 버튼이 나타나지 않는 문제 해결
  - 외부 클릭 핸들러가 버튼 클릭도 감지하여 메뉴를 즉시 닫는 문제 수정
  - 드롭다운 버튼에 `dropdown-button` 클래스 추가
  - 외부 클릭 핸들러에 드롭다운 버튼 예외 처리 추가
  - 이벤트 버블링 방지를 위해 e.stopPropagation() 추가
  - 드롭다운 메뉴 z-index를 z-20으로 높여 다른 요소 위에 표시되도록 수정
  - 수정/삭제 버튼 클릭 후 드롭다운 메뉴가 자동으로 닫히도록 개선
- **메모리 삭제 오류 수정**
  - 삭제 시 400 에러 발생 문제 해결
  - 원인 1: RLS 정책은 `created_by` 컬럼을 확인하지만 코드는 `user_id`를 사용
    - Memory 인터페이스에 `created_by` 필드 추가 ✓
    - 삭제 mutation에서 `user_id` 조건 제거 (RLS가 자동으로 처리) ✓
    - 드롭다운 표시 조건을 `user_id` 대신 `created_by` 사용으로 변경 ✓
  - 원인 2: 현재 사용자 역할이 'viewer'로 되어 있어 삭제 권한 없음
    - 권한 오류 시 명확한 메시지 표시 추가 ✓
    - 한국어/영어/태국어 번역 추가 ✓
    - `database-fix-memories-delete-policy.sql` 파일 생성 ✓
    - `docs/FIX_MEMORY_DELETE_ERROR.md` 가이드 문서 생성 ✓
  - **해결 방법**: Supabase 대시보드에서 사용자 역할을 'parent'로 변경 필요
- **관리자 페이지 프로필 편집 기능 추가**
  - "이름 없음"으로 표시되는 사용자 정보 문제 해결
  - 프로필 편집 모달 추가 (이메일, 이름, 사용자명 입력)
  - 이메일 정보 표시를 위한 RPC 함수 SQL 생성
  - 프로필 업데이트 mutation 구현
  - `database-get-users-with-email-rpc.sql` 파일 생성
  - **필요 작업**: Supabase 대시보드에서 RPC 함수 생성 필요
- **관리자 페이지 다국어 지원 추가** ✓
  - AdminPage 컴포넌트에 언어 변환 시스템 적용
  - 한국어, 영어, 태국어 번역 추가
  - admin 섹션 번역 키 추가 (사용자 관리, 활동 로그, 권한 관련)
  - 모든 하드코딩된 텍스트를 번역 키로 교체
  - 날짜 형식을 언어별로 다르게 적용
  - 프로필 편집 모달 다국어 지원
  - 빈 활동 로그 상태 메시지 추가
